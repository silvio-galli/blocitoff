<div class="row">
  <div class="col-md-8">
    <h1>Welcome <span class="label label-success"><%= @user.name %></span> <small>active since: <%= @user.created_at.strftime("%B %d, %Y") %></small></h1>
  </div>
  <div class="col-md-4">
    <%= link_to "New Task", new_task_path, class: 'btn btn-primary' %>
  </div>
</div>
<br />
<div class="row">
  <div class="col-md-8">
    <h1>Active tasks</h1>
    <table class="table table-bordered table-hover">
      <tr class="table-heading">
        <th>title</th>
        <th>expected end in</th>
        <th></th>
        <th></th>
      </tr>
      <% @active_tasks.each do |task| %>
        <tr>
          <td><%= task.title %></td>
          <td><%= time_left(task) %></td>
          <td>
            <%= form_for task do |t| %>
              <%= t.hidden_field :completed, id: "task_#{task.id}_completed", value: "1" %>
              <%= t.submit "completed", class: 'btn btn-success' %>
            <% end %>
          </td>
          <td>
            <%= form_for task do |t| %>
              <%= t.hidden_field :deleted, id: "task_#{task.id}_deleted", value: "1" %>
              <%= t.submit "delete", class: 'btn btn-danger' %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  </div>
  <div class=col-md-4>
    <% if @completed_tasks == [] %>
      <h3>No completed tasks, for the moment</h3>
    <% else %>
      <h3>Completed tasks</h3>
      <table class="table">
        <% @completed_tasks.limit(5).each do |task| %>
          <tr>
            <td class="text-muted"><%= task.title %></td>
            <td class="text-muted">completed in <%= completion_time(task) %></td>
          </tr>
        <% end %>
      </table>
    <% end %>

    <% if @deleted_tasks == [] %>
      <h3>No deleted tasks, for the moment</h3>
    <% else %>
      <h3>Deleted tasks</h3>
      <table class="table">
        <% @deleted_tasks.limit(5).each do |task| %>
          <tr>
            <td class="text-muted"><del><%= task.title %></del></td>
            <td class="text-muted"><del>deleted after <%= deletion_time(task) %></del></td>
          </tr>
        <% end %>
      </table>
    <% end %>

    <% if @uncompleted_tasks == [] %>
      <h3>No uncompleted tasks, for the moment</h3>
    <% else %>
      <h3>Uncompleted tasks</h3>
      <table class="table">
        <% @uncompleted_tasks.limit(5).each do |task| %>
          <tr>
            <td class="text-muted"><del><%= task.title %></del></td>
          </tr>
        <% end %>
      </table>
    <% end %>
  </div>
</div>
